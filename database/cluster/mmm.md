# mmm (Multi Master Replication Manager)
多主复制管理器

![[imgs/Pasted image 20230402112447.png]]

| 资源     | 数量  | 说明                                       |
| -------- | ----- | ------------------------------------------ |
| 主DB     | 2     | 用于主备模式的主主复制                     |
| 从DB     | 0-N台 | 可以根据需要配置N台从服务器                |
| ip地址   | 2n+1  | N为Myql服务器的数量                        |
| 监控用户 | 1     | 用户监控数据库状态的MySQL用户(replication) |
| 代理用户 | 1     | 用于MMM代理端改变read_only状态             |

## 故障转移步骤

- slave 服务器的操作
    - 完成原主上已经复制的日志恢复
    - 使用 change master 命令配置新主

- 主服务器上操作
    - 设置 read_only 关闭
    - 迁移VIP到新主服务器

优点: 
- 提供了读写VIP的配置，试读写请求都可以达到高可用
- 工具包相对比较完善，不需要额外的开发脚本
- 完成故障转移之后可以对MySQL集群进行高可用监控

缺点：
- 故障简单粗暴，容易丢失事务，建议采用半同步复制方式，减少失败的概率
- 目前MMM社区已经缺少维护，不支持基于GTID的复制

适用场景：
- 读写都需要高可用的
- 基于日志点的复制方式
