### 描述
DES(Data Encryption Standard)是流行的对称加密算法

### 原理介绍
1. 长度
明文与密文64位分组
密钥为64位,密钥每八位奇偶校验位,所以实际密钥长度为56(64-8)位

2. 流程
![[imgs/Pasted image 20230301123942.png]]

  1. 初始置换
  ![[imgs/Pasted image 20230301125506.png]]
  ```
# 例子
    明文 M = 0110001101101111011011010111000001110101011101000110010101110010
    初始置换表 IP = 
        58,50,42,34,26,18,10,02,
        60,52,44,36,28,20,12,04,
        62,54,46,38,30,22,14,06,
        64,56,48,40,32,24,16,08,
        57,49,41,33,25,17,09,01,
        59,51,43,35,27,19,11,03,
        61,53,45,37,29,21,13,05,
        63,55,47,39,31,23,15,07,
        (里面数据指的是替换的位置,例如58指将M的58位放置到M'第1位)

    M经过IP置换后得M'
    M' = 1111111110111000011101100101011100000000111111110000011010000011

    取M'前32位作为L0
    L0 = 11111111101110000111011001010111
    取M'前32位作为R0
    R0 = 00000000111111110000011010000011
    
  ```
  2. 子密钥生成
![[imgs/Pasted image 20230301131410.png]]
```
# 例子
    密钥 K = 0001001100110100010101110111100110011011101111001101111111110001
    PC-1 = 
        57,49,41,33,25,17,09
        01,58,50,42,34,26,18
        10,02,59,51,43,35,27
        19,11,03,60,52,44,36
        63,55,47,39,31,23,15
        07,62,54,46,38,30,22
        14,06,61,53,45,37,29
        21,13,05,28,20,12,04
        (PC-1表为8行7列的表，密钥K经PC-1后变为56位数据K')

    K经过IP置换后得K'
    K' = 11110000110011001010101011110101010101100110011110001111

    取K'前32位作为C0
    C0 = 1111000011001100101010101111
    取K'前32位作为D0
    D0 = 0101010101100110011110001111

    每轮移动位数表
    轮数 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
    位数 1 1 2 2 2 2 2 2 1  2  2  2  2  2  2  1

    # 第一轮位移,轮数为1,左移位数为1
    C0左移1位为C1
    C1（28位） = 1110000110011001010101011111
    D0左移1位为D1
    D1（28位） = 1010101011001100111100011110

    PC-2 = 
        14,17,11,24,01,05,
        03,28,15,06,21,10,
        23,19,12,04,26,08,
        16,07,27,20,13,02,
        41,52,31,37,47,55,
        30,40,51,45,33,48,
        44,49,39,56,34,53,
        46,42,50,36,29,32

    C1与D1合并经过PC-2置换后的数据为48位，置换后得到密钥K1，
    K1 = 000110110000001011101111111111000111000001110010

    # 第二轮位移,轮数为2,左移位数为1
    C1左移1位为C2
    C2 = 1100001100110010101010111111
    D1左移1位为D2
    D2 = 0101010110011001111000111101

    C2和D2合并后为56位，经过PC-2表置换得到密钥K2（48位）
    K2（48位）= 011110011010111011011001110110111100100111100101

    依次类推,获得K3-K16

```
    3. 迭代
![[imgs/Pasted image 20230301135731.png]]
```
    Li = R(i-1);
    Ri = Li⊕ f(R(i-1), Ki);

    扩展置换E = 
        32,01,02,03,04,05,
        04,05,06,07,08,09,
        08,09,10,11,12,13,
        12,13,14,15,16,17,
        16,17,18,19,20,21,
        20,21,22,23,24,25,
        24,25,26,27,28,29,
        28,29,30,31,32,01
        (Ri(右部分)32位,密钥Ki是48位,确保可以进行异或运算需要此表进行置换)
# 例如
    L0 = 11111111101110000111011001010111
    R0 = 00000000111111110000011010000011
    R0经过E置换后得E_R0
    E_R0 = 100000000001011111111110100000001101010000000110

    E_R0与K1异或得E_R0_K1
    E_R0_K1 = 100110110001010100010001011111001010010001110100


    S 盒替代
        代替运算由8个不同的代替盒(S盒)完成
        每个S盒有6位输入,4位输出

    s 盒1
        14,04,13,01,02,15,11,08,03,10,06,12,05,09,00,07,
        00,15,07,04,14,02,13,01,10,06,12,11,09,05,03,08,
        04,01,14,08,13,06,02,11,15,12,09,07,03,10,05,00,
        15,12,08,02,04,09,01,07,05,11,03,14,10,00,06,13,
    s 盒2
        15,01,08,14,06,11,03,04,09,07,02,13,12,00,05,10,
        03,13,04,07,15,02,08,14,12,00,01,10,06,09,11,05,
        00,14,07,11,10,04,13,01,05,08,12,06,09,03,02,15,
        13,08,10,01,03,15,04,02,11,06,07,12,00,05,14,09,
    s 盒3
        10,00,09,14,06,03,15,05,01,13,12,07,11,04,02,08,
        13,07,00,09,03,04,06,10,02,08,05,14,12,11,15,01,
        13,06,04,09,08,15,03,00,11,01,02,12,05,10,14,07,
        01,10,13,00,06,09,08,07,04,15,14,03,11,05,02,12,
    s 盒4
        07,13,14,03,00,06,09,10,01,02,08,05,11,12,04,15,
        13,08,11,05,06,15,00,03,04,07,02,12,01,10,14,09,
        10,06,09,00,12,11,07,13,15,01,03,14,05,02,08,04,
        03,15,00,06,10,01,13,08,09,04,05,11,12,07,02,14,
    s 盒5
        02,12,04,01,07,10,11,06,08,05,03,15,13,00,14,09,
        14,11,02,12,04,07,13,01,05,00,15,10,03,09,08,06,
        04,02,01,11,10,13,07,08,15,09,12,05,06,03,00,14,
        11,08,12,07,01,14,02,13,06,15,00,09,10,04,05,03,
    s 盒6
        12,01,10,15,09,02,06,08,00,13,03,04,14,07,05,11,
        10,15,04,02,07,12,09,05,06,01,13,14,00,11,03,08,
        09,14,15,05,02,08,12,03,07,00,04,10,01,13,11,06,
        04,03,02,12,09,05,15,10,11,14,01,07,06,00,08,13,
    s 盒7
        04,11,02,14,15,00,08,13,03,12,09,07,05,10,06,01,
        13,00,11,07,04,09,01,10,14,03,05,12,02,15,08,06,
        01,04,11,13,12,03,07,14,10,15,06,08,00,05,09,02,
        06,11,13,08,01,04,10,07,09,05,00,15,14,02,03,12,
    s 盒8
        13,02,08,04,06,15,11,01,10,09,03,14,05,00,12,07,
        01,15,13,08,10,03,07,04,12,05,06,11,00,14,09,02,
        07,11,04,01,09,12,14,02,00,06,10,13,15,03,05,08,
        02,01,14,07,04,10,08,13,15,12,09,00,03,05,06,11,

    S 盒计算规则
#例如
    若S-盒1的输入为110111,第一位与最后一位构成11,十进制值为3,则对应第3行,中间4位为1011对应的十进制值为11,则对应第11列
    查找S-盒1表的值为14，则S-盒1的输出为1110
    8个S盒将输入的48位数据输出为32位数据

    E_R0_K1经过S合得E_R0_K1_S
    E_R0_K1_S = 10001011110001000110001011101010


    P 盒置换
    P盒表 = 
        16,07,20,21,29,12,28,17,01,15,23,26,05,18,31,10,
        02,08,24,14,32,27,03,09,19,13,30,06,22,11,04,25,

    将经过S盒的输出E_R0_K1_S输入P盒得E_R0_K1_S_P
    E_R0_K1_S_P = 01001000101111110101010110000001
```
	4 逆置换
![[imgs/Pasted image 20230301142805.png]]
```
    将初始置换进行16次的迭代,即进行16层的加密变换,得到L16和R16,将此作为输入块,进行逆置换得到最终的密文输出块
    逆置换是初始置换的逆运算
    从初始置换规则中可以看到,原始数据的第1位置换到了第40位,第2位置换到了第8位
    则逆置换就是将第40位置换到第1位,第8位置换到第2位
    以此类推

    逆置换规则表 = 
        40,08,48,16,56,24,64,32,
        39,07,47,15,55,23,63,31,
        38,06,46,14,54,22,62,30,
        37,05,45,13,53,21,61,29,
        36,04,44,12,52,20,60,28,
        35,03,43,11,51,19,59,27,
        34,02,42,10,50,18,58 26,
        33,01,41,09,49,17,57,25,
```
